<!DOCTYPE html>
<html lang="nl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Werkvergunning - Vak VI</title>
    <link rel="stylesheet" href="../CSS/werkvergunning-base.css">
    <link rel="stylesheet" href="../CSS/werkvergunning_vak6.css">
    <link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Material+Symbols+Outlined:opsz,wght,FILL,GRAD@20..48,100..700,0..1,-50..200" />
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
</head>
<body>
    <!-- Header -->
    <header class="header">
        <div class="header-left">
            <div class="header-icon">
                <i class="far fa-file-lines"></i>
            </div>
            <div class="header-title">
                <h1>Werkvergunning Portaal</h1>
                <p>Welkom, <span class="role-badge"><i class="fas fa-user"></i> <span id="userRole">Gebruiker</span></span></p>
            </div>
        </div>
        <div class="header-center">
            <img src="../IMAGES/logo-beveren.jpg" alt="Beveren Logo" class="header-logo">
        </div>
        <div class="header-right">
            <button class="logout-btn" onclick="window.location.href='../index.html'">
                <i class="fas fa-sign-out-alt"></i>
                <span>Uitloggen</span>
            </button>
        </div>
    </header>

    <!-- Main Content -->
    <main class="main-container">
        <div class="form-card">
            <div class="form-title">
                <span>Vak VI. BEKRACHTIGING</span>
                <span class="warning-box inline">DEZE VERGUNNING VERVALT OGENBLIKKELIJK BIJ EEN NOODSITUATIE!</span>
            </div>

            <!-- LOTOTO Check -->
            <div class="form-section">
                <div class="warning-inline-container">
                    <i class="fas fa-exclamation-triangle warning-icon"></i>
                    <span>De LOTOTO-checklijst werd gecontroleerd op VOLLEDIGHEID en is OK voor VRIJGAVE INSTALLATIE:</span>
                    <div class="checkbox-group checkbox-group-inline">
                        <div class="checkbox-item">
                            <input type="checkbox" id="lototo_ja" name="lototo">
                            <label for="lototo_ja">Ja</label>
                        </div>
                        <div class="checkbox-item">
                            <input type="checkbox" id="lototo_nvt" name="lototo">
                            <label for="lototo_nvt">NVT</label>
                        </div>
                    </div>
                    <div id="loto_status_indicator" class="loto-status-indicator" style="display: none;">
                        <span class="material-symbols-outlined">info</span>
                        <span id="loto_status_text"></span>
                    </div>
                    <i class="fas fa-exclamation-triangle warning-icon"></i>
                </div>

                <div class="info-box">
                    <p><strong>Afdeling:</strong> De vergunning is grondig voorbereid, de nodige vergunningen zijn bijgevoegd, de uitvoerders werden geïnformeerd, de werkplek werd geïnspecteerd!</p>
                    <p><strong>Uitvoerder:</strong> Ik ben akkoord met al de vereisten die besproken zijn, en informeer al mijn medewerkers deze maatregelen te handhaven.</p>
                </div>

                <!-- Table -->
                <table class="form-table">
                    <thead>
                        <tr>
                            <th>Dag</th>
                            <th>Datum</th>
                            <th>Van...</th>
                            <th>Tot...</th>
                            <th colspan="2">AFDELING</th>
                            <th colspan="2">UITVOERDER</th>
                            <th>Aantal uitvoerders</th>
                            <th>Afd.overdracht handtekening</th>
                        </tr>
                        <tr>
                            <th></th>
                            <th></th>
                            <th></th>
                            <th></th>
                            <th>Naam</th>
                            <th>paraaf</th>
                            <th>Naam</th>
                            <th>paraaf</th>
                            <th></th>
                            <th></th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr>
                            <td><input type="text"></td>
                            <td><input type="date"></td>
                            <td><input type="text" value="u"></td>
                            <td><input type="text" value="u"></td>
                            <td><input type="text"></td>
                            <td><input type="text"></td>
                            <td><input type="text"></td>
                            <td><input type="text"></td>
                            <td><input type="text"></td>
                            <td><input type="text"></td>
                        </tr>
                        <tr>
                            <td><input type="text"></td>
                            <td><input type="date"></td>
                            <td><input type="text" value="u"></td>
                            <td><input type="text" value="u"></td>
                            <td><input type="text"></td>
                            <td><input type="text"></td>
                            <td><input type="text"></td>
                            <td><input type="text"></td>
                            <td><input type="text"></td>
                            <td><input type="text"></td>
                        </tr>
                        <tr>
                            <td><input type="text"></td>
                            <td><input type="date"></td>
                            <td><input type="text" value="u"></td>
                            <td><input type="text" value="u"></td>
                            <td><input type="text"></td>
                            <td><input type="text"></td>
                            <td><input type="text"></td>
                            <td><input type="text"></td>
                            <td><input type="text"></td>
                            <td><input type="text"></td>
                        </tr>
                        <tr>
                            <td><input type="text"></td>
                            <td><input type="date"></td>
                            <td><input type="text" value="u"></td>
                            <td><input type="text" value="u"></td>
                            <td><input type="text"></td>
                            <td><input type="text"></td>
                            <td><input type="text"></td>
                            <td><input type="text"></td>
                            <td><input type="text"></td>
                            <td><input type="text"></td>
                        </tr>
                        <tr>
                            <td><input type="text"></td>
                            <td><input type="date"></td>
                            <td><input type="text" value="u"></td>
                            <td><input type="text" value="u"></td>
                            <td><input type="text"></td>
                            <td><input type="text"></td>
                            <td><input type="text"></td>
                            <td><input type="text"></td>
                            <td><input type="text"></td>
                            <td><input type="text"></td>
                        </tr>
                    </tbody>
                </table>
            </div>

            <!-- Navigation Buttons -->
            <div class="navigation-buttons">
                <button class="nav-button prev" onclick="goBackFromVak6()">Vorige</button>
                <button class="nav-button button next" onclick="navigateToNext('werkvergunning_vak7.html')">Volgende</button>

            </div>
        </div>
    </main>

    <script src="https://kit.fontawesome.com/fec428329f.js" crossorigin="anonymous"></script>
    <script src="../JS/saveCurrentVak.js"></script>
    <script>
        const role = sessionStorage.getItem('userRole');
        const roleNames = {
            'leerling': 'Leerling/Externe',
            'leerkracht': 'Leerkracht',
            'ta': 'TA',
            'directeur': 'Directeur'
        };
        if (role && document.getElementById('userRole')) {
            document.getElementById('userRole').textContent = roleNames[role] || 'Gebruiker';
        }

        // Synchroniseer LOTO status met LOTOTO check
        function syncLOTOStatus() {
            const lotoStatus = sessionStorage.getItem('loto_status');
            const lotoRequired = sessionStorage.getItem('loto_required');
            const lototoJa = document.getElementById('lototo_ja');
            const lototoNvt = document.getElementById('lototo_nvt');
            const statusIndicator = document.getElementById('loto_status_indicator');
            const statusText = document.getElementById('loto_status_text');
            
            if (lotoRequired === 'true' && statusIndicator && statusText) {
                statusIndicator.style.display = 'flex';
                
                if (lotoStatus === 'nvt') {
                    statusText.textContent = 'LOTO status: Niet van toepassing (NVT)';
                    statusIndicator.style.backgroundColor = '#fff3cd';
                    statusIndicator.style.borderLeft = '4px solid #ffc107';
                    if (lototoNvt) {
                        lototoNvt.checked = true;
                        lototoJa.checked = false;
                    }
                } else if (lotoStatus === 'ingevuld') {
                    statusText.textContent = 'LOTO status: Volledig ingevuld';
                    statusIndicator.style.backgroundColor = '#d4edda';
                    statusIndicator.style.borderLeft = '4px solid #28a745';
                    if (lototoJa) {
                        lototoJa.checked = true;
                        lototoNvt.checked = false;
                    }
                } else {
                    statusText.textContent = 'LOTO status: Nog niet ingevuld';
                    statusIndicator.style.backgroundColor = '#f8d7da';
                    statusIndicator.style.borderLeft = '4px solid #dc3545';
                }
            }
        }

        // Setup Ja/NVT checkboxes om elkaar uit te sluiten
        function setupLototoCheckboxes() {
            const lototoJa = document.getElementById('lototo_ja');
            const lototoNvt = document.getElementById('lototo_nvt');
            
            if (lototoJa && lototoNvt) {
                lototoJa.addEventListener('change', function() {
                    if (this.checked) {
                        lototoNvt.checked = false;
                    }
                });
                
                lototoNvt.addEventListener('change', function() {
                    if (this.checked) {
                        lototoJa.checked = false;
                    }
                });
            }
        }

        // Navigatie terug functie
        function goBackFromVak6() {
            const lotoRequired = sessionStorage.getItem('loto_required');
            if (lotoRequired === 'true') {
                window.location.href = 'werkvergunning_loto.html';
            } else {
                window.location.href = 'werkvergunning_preventie.html';
            }
        }

        // Initialize on page load
        document.addEventListener('DOMContentLoaded', function() {
            syncLOTOStatus();
            setupLototoCheckboxes();
        });
    </script>
</body>
</html>